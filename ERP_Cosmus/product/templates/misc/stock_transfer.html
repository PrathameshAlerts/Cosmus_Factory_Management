{% extends 'product/base.html' %}
{% load static %}

{% block body %}
<div>
  <h2>Stock Transfer</h2>
  <form class="mt-5" action="" method="POST">
    {% csrf_token %}
    <div class="d-flex mb-3">
      <label for="" class="form-label px-2">Stock Voucher No:</label>
      <input type="number" class="item-select mx-3" value="" name="voucher_no" maxlength="50" required id="">

      <div class="ms-auto">
        <label for="" class="form-label px-2">Date:</label>
        <span>{{ current_date }}</span>
      </div>
    </div>

    <div class="d-flex mb-3">
      <div>
        <label for="" class="form-label px-2">Source Godown:</label>
        <p>(Transfer from)</p>
      </div>

      <div class=" d-flex mb-3">

        <select value="" class="item-select" name="source_godown" required id="id_source_godown">

          {% for godown in raw_godowns %}
          <option value="{{godown.id}}">{{godown.godown_name_raw}}</option>
          {% endfor %}

        </select>
      </div>
      <span class="pt-3 pe-3">To</span>
      <div>
        <label for="" class="form-label">Target Godown:</label>
        <p>(Transfer to)</p>
      </div>
      <div class=" d-flex mb-3">
        <select value="" class="item-select" name="target_godown" required id="id_target_godown">

          {% for godown in raw_godowns %}
          <option value="{{godown.id}}">{{godown.godown_name_raw}}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="">
      <table class="table table-striped table-hover table-responsive">
        <thead>
          <tr>
            <th>Item Name</th>
            <th>Color</th>
            <th>Shades</th>
            <th>QTY</th>
            <th>Per</th>
            <th>Remark</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <input list="name" class="item-select" id="nameInput">
              <datalist id="name">
               
              </datalist>
            </td>
            <td>
              <input list="color" class="item-select" id="colorInput">
              <datalist id="color">
               

              </datalist>
            </td>
           
            <td>
              <input list="shades" class="item-select" id="shadesInput">
              <datalist id="shades">
                
                
              </datalist>
            </td>
            <td>
              <input list="qty" class="item-select" id="qtyInput">
              <datalist id="qty">
                
              </datalist>
            </td>
          
            <td>
              <input list="per" class="item-select" id="perInput">
              <datalist id="per">
                
              </datalist>
            </td>
            <td>
              <span>used</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>




    <input type="submit" class="create-btn mt-4" name="save" value="Save">
    <input type="submit" class="create-btn" name="save_and_add_another" value="Save and Add Another">
    <button type="button" class="create-btn"><a class="text-decoration-none text-white" href="">Return</a></button>
  </form>
</div>
<script>
  $(document).ready(function () {
    $('select').selectize({
      sortField: 'text'
    });
  });
</script>
 <script>
        $(document).ready(function(){
            // Function to fetch data via AJAX
            function fetchData(url, dataListId) {
                $.ajax({
                    url: url,
                    type: 'GET',
                    dataType: 'json',
                    success: function(response) {
                        // Clear existing options
                        $(dataListId).empty();
                        // Append fetched data to datalist
                        response.forEach(function(item) {
                            $(dataListId).append('<option value="' + item.value + '">');
                        });
                    },
                    error: function(xhr, status, error) {
                        console.error(error);
                    }
                });
            }

            // Fetch data for name input
            fetchData('/api/items/name', '#name');
            // Fetch data for color input
            fetchData('/api/items/color', '#color');
            // Fetch data for shades input
            fetchData('/api/items/shades', '#shades');
            // Fetch data for qty input
            fetchData('/api/items/qty', '#qty');
            // Fetch data for per input
            fetchData('/api/items/per', '#per');
        });
    </script>
{% endblock body %}