{% extends 'misc/navbar_popup.html' %}
{% load static %} 

{% block body %} 
<div>

      <form id="colorForm"  action="" method="POST">
        {% csrf_token %}  
        <h2 class="mb-3 mt-4">Create Color</h2>
       <div class="d-flex">
        <label for="id_color_name" class="form-label create_color_lable">Name:</label>
        <input type="text" class="item-select" value="{{ form.instance.color_name }}" name="color_name" maxlength="255" required id="id_color_name">
       </div>

    <input type="submit" id="saveButton" class="create-btn mt-4" name="save" value="Save">
      </form>
</div>



<script>
  document.getElementById('colorForm').addEventListener('submit', async function(event) {
    event.preventDefault();  // Prevent the default form submission
    
    const form = event.target;
    const formData = new FormData(form);

    try {

      const response = await fetch(form.action ,{
        method: 'POST',
        body: formData,
        headers: {
          'X-CSRFToken': '{{ csrf_token }}',
        }
      });
       
      if(response.ok){

        const colorData = await response.json();  // Await the response.json() call
        console.log('Response data:', colorData);
        window.opener.postMessage(colorData, '*');

          window.close();  // Now you can access the JSON data
      }
      
    } catch (error) {
      
    }
  });
</script>



{% endblock body %}